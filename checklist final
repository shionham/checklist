<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>ì²´í¬ë¦¬ìŠ¤íŠ¸</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <!-- PWA -->
  <link rel="manifest" href="/manifest.json">
  <meta name="theme-color" content="#1e1e1e">
  <link rel="icon" href="/icons/icon-192x192.png" sizes="192x192">
  <link rel="icon" href="/icons/icon-512x512.png" sizes="512x512">

  <style>
    body {
      font-family: 'Arial', sans-serif;
      background: url('KakaoTalk_20250430_144930066.png') no-repeat center center fixed;
      background-size: cover;
     padding: 20px;
     transition: background 0.3s, color 0.3s;
     position: relative;
    }
    body.dark {
      background: url('KakaoTalk_20250512_234048257.png') no-repeat center center fixed;
      background-size: cover;
      color: #eee;
    }

    /* ê¸°ì¡´ dark ëª¨ë“œ ìŠ¤íƒ€ì¼ ì•„ë˜ì— ì¶”ê°€ */
body.ocean {
  background: url('KakaoTalk_20250519_230857058.png') no-repeat center center fixed;
  background-size: cover;
  color: #cce7ff;
}

body.ocean li {
  background: rgba(0, 51, 102, 0.7); /* ë°”ë‹¤ ëŠë‚Œ ë°˜íˆ¬ëª… ë°°ê²½ */
  color: #e0f7ff;
}

body.ocean button {
  background-color: #005f99;
  color: #cce7ff;
  border: none;
}

body.ocean button:hover {
  background-color: #007acc;
}

/* ë‹¤í¬ëª¨ë“œë‘ ë°”ë‹¤ëª¨ë“œ ì¤‘ë³µ ë°©ì§€ ìŠ¤íƒ€ì¼ ê³ ë ¤ëŠ” JSì—ì„œ ì²˜ë¦¬ */

body.space {
  background: url('KakaoTalk_20250519_232354191.png') no-repeat center center fixed;
  background-size: cover;
  color: #dcdcdc;
}

body.space li {
  background: rgba(10, 10, 30, 0.7);
  color: #e0e8ff;
}

body.space button {
  background-color: #2a2a72;
  color: #dcdcdc;
  border: none;
}

body.space button:hover {
  background-color: #4444aa;
}

body.wuxia {
  background: url('KakaoTalk_20250519_232640471.png') no-repeat center center fixed;
  background-size: cover;
  color: #1a1307; /* ë¬´í˜‘ ëŠë‚Œì˜ ë¶€ë“œëŸ¬ìš´ í™©í† ìƒ‰ */
  font-family: 'Noto Serif KR', serif; /* ë¬´í˜‘ ëŠë‚Œ í°íŠ¸ ì˜ˆì‹œ */
}

body.wuxia li {
  background: rgba(35, 19, 8, 0.7); /* ì§™ì€ ê°ˆìƒ‰ ë°˜íˆ¬ëª… */
  color: #ffe4c4;
  border: 1px solid #271508;
}

body.wuxia button {
  background-color: #211207;
  color: #ffe4c4;
  border: none;
  font-weight: bold;
}

body.wuxia button:hover {
  background-color: #28140a;
}






    h1 {
      text-align: center;
    }
    #controls-left {
      position: absolute;
      top: 20px;
      left: 20px;  /* ì™¼ìª½ ìœ„ë¡œ ë³€ê²½ */
      display: flex;
      flex-direction: column; /* ì„¸ë¡œë¡œ ë°°ì¹˜ */
      justify-content: flex-start;  /* ì™¼ìª½ ì •ë ¬ */
      gap: 2px;  /* ë²„íŠ¼ ì‚¬ì´ì˜ ê°„ê²© */
      align-items: flex-start; /* ì™¼ìª½ ì •ë ¬ */
      z-index: 1000;
    }
    #controls-right {
      position: absolute;
      top: 20px;
      right: 20px;  /* ì˜¤ë¥¸ìª½ ìœ„ë¡œ ë³€ê²½ */
      display: flex;
      flex-direction: row;  /* ê°€ë¡œë¡œ ë°°ì¹˜ */
      justify-content: flex-start;  /* ì™¼ìª½ ì •ë ¬ */
      gap: 2px;  /* ë²„íŠ¼ ì‚¬ì´ì˜ ê°„ê²© */
      align-items: center;  /* ì„¸ë¡œ ì¤‘ì•™ ì •ë ¬ */
      z-index: 1000;
    }
    #controls button, #controls select, #controls input {
      padding: 8px 40px;
      font-size: 16px;
      cursor: pointer;
    }
    #todo-form {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 10px;
      margin-bottom: 20px;
    }
    input[type="text"], input[type="date"], select {
      padding: 10px;
      font-size: 16px;
      width: 180px;
    }
    button {
      padding: 8px 12px;
      font-size: 16px;
      cursor: pointer;
    }
    ul {
      list-style: none;
      padding: 0;
      margin: 0;               /* ì¤‘ì•™ ì •ë ¬ ì œê±° */
      width: 100%;             /* ì „ì²´ ë„ˆë¹„ ì‚¬ìš© */
      text-align: left; 
    }
    li {
      background: white;
      margin: 10px 0;
      padding: 10px;
      border-radius: 5px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      flex-wrap: wrap;
      transition: border 0.3s;
      gap: 8px;
      max-width: 30%;
    }
    body.dark li {
      background: #333;
    }
    .completed {
      text-decoration: line-through;
      color: gray;
    }
    @media (max-width: 600px) {
      #todo-form {
        flex-direction: column;
        align-items: stretch;
      }
      input, select, button {
        width: 100% !important;
      }
    }
    #history-modal {
      background: white;
      padding: 20px;
      border-radius: 8px;
      max-width: 1000px;
      margin: 20px auto;
      display: none;

      #history-list {
    text-align: center;
    padding-left: 0;
  }

  #history-list li {
    display: block;
    margin: 4px auto;
  }
    }

    
    body.dark #history-modal {
      background: #444;

       #history-list {
    text-align: center;
    padding-left: 0;
  }

  #history-list li {
    display: block;
    margin: 4px auto;
  }
    }
  </style>
</head>
<body>
  <h1>ğŸ“ ì²´í¬ë¦¬ìŠ¤íŠ¸</h1>
  <div id="rank-display" style="text-align: center; font-weight: bold; margin-bottom: 10px;"></div>

  <!-- ì ìˆ˜ ì´ˆê¸°í™” ë²„íŠ¼ ì¶”ê°€ -->
<div id="controls-left">
    <button onclick="toggleDarkMode()">ğŸŒ™ ì•¼ê°„ëª¨ë“œ</button>
    <button onclick="toggleOceanMode()">ğŸŒŠ ë°”ë‹¤ëª¨ë“œ</button>
    <button onclick="toggleSpaceMode()">ğŸš€ ìš°ì£¼ëª¨ë“œ</button>
    <button onclick="toggleWuxiaMode()">âš”ï¸ ë¬´í˜‘ëª¨ë“œ</button>
  </div>

  
  

  <div id="controls-right">
    <input type="date" id="due-date" style="padding: 6px; font-size: 14px;">
    <button onclick="toggleHistory()">ğŸ“… ê¸°ë¡ ë³´ê¸°</button>
    <button onclick="resetPointsAndRank()">ğŸ”„ ì ìˆ˜ ì´ˆê¸°í™”</button> <!-- ì´ˆê¸°í™” ë²„íŠ¼ -->
  </div>

  <div id="todo-form">
    <input type="text" id="new-task" placeholder="í•  ì¼ ì…ë ¥">



    <button onclick="addTask()">ì¶”ê°€</button>
  </div>

  <ul id="todo-list"></ul>

  <div id="history-modal">
    <h3>ğŸ“– í•  ì¼ ê¸°ë¡</h3>
    <ul id="history-list"></ul>
  </div>

  <script>

let point = parseInt(localStorage.getItem("point") || "0");

function calculateRank(score) {
  if (score >= 2000) return "ğŸ’ ë‹¤ì´ì•„ëª¬ë“œ";
  if (score >= 1000) return "ğŸ”· í”Œë˜í‹°ë„˜";
  if (score >= 500) return "ğŸ¥‡ ê³¨ë“œ";
  if (score >= 200) return "ğŸ¥ˆ ì‹¤ë²„";
  if (score >= 50) return "ğŸ¥‰ ë¸Œë¡ ì¦ˆ";
  return "ğŸ¯ ë­í¬ ì—†ìŒ";
}

function updateRankDisplay() {
  const rankText = `${point}ì  - í˜„ì¬ ë“±ê¸‰: ${calculateRank(point)}`;
  document.getElementById("rank-display").textContent = rankText;
}

function addPoints(amount) {
  point += amount;
  localStorage.setItem("point", point);
  updateRankDisplay();
}


    let tasks = JSON.parse(localStorage.getItem("tasks")) || [];
    let historyLog = JSON.parse(localStorage.getItem("historyLog")) || {};

    function saveTasks() {
      localStorage.setItem("tasks", JSON.stringify(tasks));
    }

    function saveHistoryLog() {
      localStorage.setItem("historyLog", JSON.stringify(historyLog));
    }

    function isDueSoon(dateStr) {
      if (!dateStr) return false;
      const today = new Date();
      const due = new Date(dateStr);
      const diff = (due - today) / (1000 * 60 * 60 * 24);
      return diff <= 1 && diff >= 0;
    }

    function resetPointsAndRank() {
  point = 0; // ì ìˆ˜ ì´ˆê¸°í™”
  localStorage.setItem("point", point); // ë¡œì»¬ìŠ¤í† ë¦¬ì§€ì— ì´ˆê¸°í™”ëœ ì ìˆ˜ ì €ì¥
  updateRankDisplay(); // UIì— ë°˜ì˜

  function addPoints(amount) {
  point += amount;
  localStorage.setItem("point", point);
  updateRankDisplay();
}

function updateRankDisplay() {
  const rankText = `${point}ì  - í˜„ì¬ ë“±ê¸‰: ${calculateRank(point)}`;
  document.getElementById("rank-display").textContent = rankText;
}

document.addEventListener("DOMContentLoaded", () => {
  updateRankDisplay();  // í˜ì´ì§€ ë¡œë“œ ì‹œ ì´ˆê¸° ì ìˆ˜ì™€ ë­í¬ í‘œì‹œ
});
}

    function renderTasks() {
      const list = document.getElementById("todo-list");
      list.innerHTML = "";

      tasks.forEach((task, index) => {
        const li = document.createElement("li");
        if (isDueSoon(task.due)) {
          li.style.border = "2px solid red";
        }

        const span = document.createElement("span");
        span.textContent = task.text;

        if (task.done) span.classList.add("completed");

        const completeBtn = document.createElement("button");
        completeBtn.textContent = task.done ? "âœ… ì™„ë£Œë¨" : "âœ” ì™„ë£Œ";
        completeBtn.disabled = task.done;
        completeBtn.onclick = () => toggleTask(index);

        const deleteBtn = document.createElement("button");
        deleteBtn.textContent = "ğŸ—‘ ì‚­ì œ";
        deleteBtn.onclick = () => deleteTask(index);

        li.appendChild(span);
        li.appendChild(completeBtn);
        li.appendChild(deleteBtn);
        list.appendChild(li);
      });
    }

    function addTask() {
      const text = document.getElementById("new-task").value.trim();
      const due = document.getElementById("due-date").value;


      if (text === "") return;

      tasks.push({ text, due, done: false });
      saveTasks();

      document.getElementById("new-task").value = "";
      renderTasks();
    }

    function toggleTask(index) {

      tasks[index].done = true;

      const now = new Date();
      const key = now.toLocaleDateString("ko-KR");
      const dayOfWeek = now.toLocaleString('ko-KR', { weekday: 'long' });
      if (!historyLog[key]) historyLog[key] = [];
      historyLog[key].push(`âœ… ì™„ë£Œ: ${tasks[index].text} (${dayOfWeek})`);

      addPoints(10); // 10ì  ì¶”ê°€

      saveTasks();
      saveHistoryLog();
      renderTasks();
    }

    function deleteTask(index) {
      tasks.splice(index, 1);
      saveTasks();
      renderTasks();
    }


    function toggleDarkMode() {
      document.body.classList.toggle("dark");
      localStorage.setItem("darkMode", document.body.classList.contains("dark"));
    }

    // ë°”ë‹¤ ëª¨ë“œ í† ê¸€ í•¨ìˆ˜ ì¶”ê°€
function toggleOceanMode() {
  const body = document.body;
  const isOcean = body.classList.contains("ocean");
  if (isOcean) {
    body.classList.remove("ocean");
    localStorage.setItem("oceanMode", "false");
  } else {
    body.classList.add("ocean");
    body.classList.remove("dark"); // ë‹¤í¬ ëª¨ë“œ í•´ì œ
    body.classList.remove("space");
    body.classList.remove("wuxia");
    localStorage.setItem("oceanMode", "true");
    localStorage.setItem("darkMode", "false");
    localStorage.setItem("spaceMode", "false");
    localStorage.setItem("wuxiaMode", "false");
  }
}

// ê¸°ì¡´ ë‹¤í¬ëª¨ë“œ í•¨ìˆ˜ì— ë°”ë‹¤ëª¨ë“œ í•´ì œ ì¶”ê°€
function toggleDarkMode() {
  const body = document.body;
  const isDark = body.classList.contains("dark");
  if (isDark) {
    body.classList.remove("dark");
    localStorage.setItem("darkMode", "false");
  } else {
    body.classList.add("dark");
    body.classList.remove("ocean"); // ë°”ë‹¤ ëª¨ë“œ í•´ì œ
    body.classList.remove("space");
    body.classList.remove("wuxia");
    localStorage.setItem("darkMode", "true");
    localStorage.setItem("oceanMode", "false");
    localStorage.setItem("spaceMode", "false");
    localStorage.setItem("wuxiaMode", "false");
  }
}

function toggleSpaceMode() {
  const body = document.body;
  const isSpace = body.classList.contains("space");
  if (isSpace) {
    body.classList.remove("space");
    localStorage.setItem("spaceMode", "false");
  } else {
    body.classList.add("space");
    body.classList.remove("dark");
    body.classList.remove("ocean");
    body.classList.remove("wuxia");
    localStorage.setItem("spaceMode", "true");
    localStorage.setItem("darkMode", "false");
    localStorage.setItem("oceanMode", "false");
    localStorage.setItem("wuxiaMode", "false");
  }
}

// í˜ì´ì§€ ë¡œë“œ ì‹œ ì €ì¥ëœ ëª¨ë“œ ì ìš©ì— ìš°ì£¼ëª¨ë“œë„ ì¶”ê°€
if (localStorage.getItem("darkMode") === "true") {
  document.body.classList.add("dark");
  document.body.classList.remove("ocean");
  document.body.classList.remove("space");
  document.body.classList.remove("wuxia");
} else if (localStorage.getItem("oceanMode") === "true") {
  document.body.classList.add("ocean");
  document.body.classList.remove("dark");
  document.body.classList.remove("space");
  document.body.classList.remove("wuxia");
} else if (localStorage.getItem("spaceMode") === "true") {
  document.body.classList.add("space");
  document.body.classList.remove("dark");
  document.body.classList.remove("ocean");
  document.body.classList.remove("wuxia");
}

function toggleWuxiaMode() {
  const body = document.body;
  const isWuxia = body.classList.contains("wuxia");
  if (isWuxia) {
    body.classList.remove("wuxia");
    localStorage.setItem("wuxiaMode", "false");
  } else {
    body.classList.add("wuxia");
    body.classList.remove("dark");
    body.classList.remove("ocean");
    body.classList.remove("space");
    localStorage.setItem("wuxiaMode", "true");
    localStorage.setItem("darkMode", "false");
    localStorage.setItem("oceanMode", "false");
    localStorage.setItem("spaceMode", "false");
  }
}

// í˜ì´ì§€ ë¡œë“œì‹œ ì €ì¥ëœ ëª¨ë“œ ì ìš© ë¶€ë¶„ì— ë¬´í˜‘ëª¨ë“œ ì¶”ê°€
if (localStorage.getItem("darkMode") === "true") {
  document.body.classList.add("dark");
  document.body.classList.remove("ocean");
  document.body.classList.remove("space");
  document.body.classList.remove("wuxia");
} else if (localStorage.getItem("oceanMode") === "true") {
  document.body.classList.add("ocean");
  document.body.classList.remove("dark");
  document.body.classList.remove("space");
  document.body.classList.remove("wuxia");
} else if (localStorage.getItem("spaceMode") === "true") {
  document.body.classList.add("space");
  document.body.classList.remove("dark");
  document.body.classList.remove("ocean");
  document.body.classList.remove("wuxia");
} else if (localStorage.getItem("wuxiaMode") === "true") {
  document.body.classList.add("wuxia");
  document.body.classList.remove("dark");
  document.body.classList.remove("ocean");
  document.body.classList.remove("space");
}

// í˜ì´ì§€ ë¡œë“œ ì‹œ ì €ì¥ëœ ëª¨ë“œ ì ìš©
if (localStorage.getItem("darkMode") === "true") {
  document.body.classList.add("dark");
  document.body.classList.remove("ocean");
} else if (localStorage.getItem("oceanMode") === "true") {
  document.body.classList.add("ocean");
  document.body.classList.remove("dark");
}

    function toggleHistory() {
      const modal = document.getElementById("history-modal");
      const list = document.getElementById("history-list");
      list.innerHTML = "";

      if (!Object.keys(historyLog).length) {
        const li = document.createElement("li");
        li.textContent = "ğŸ“­ ê¸°ë¡ì´ ì—†ìŠµë‹ˆë‹¤.";
        list.appendChild(li);
      } else {
        Object.entries(historyLog).sort((a, b) => new Date(b[0]) - new Date(a[0])).forEach(([date, entries]) => {
          const dateHeader = document.createElement("li");
          dateHeader.innerHTML = `<strong>ğŸ“… ${date}</strong>`;
          
          const deleteHistoryBtn = document.createElement("button");
          deleteHistoryBtn.textContent = "ğŸ—‘ ì‚­ì œ";
          deleteHistoryBtn.onclick = () => deleteHistory(date);

          dateHeader.appendChild(deleteHistoryBtn);
          list.appendChild(dateHeader);

          entries.forEach(entry => {
            const li = document.createElement("li");
            li.textContent = entry;
            list.appendChild(li);
          });
        });
      }

      modal.style.display = modal.style.display === "none" ? "block" : "none";
    }

    function deleteHistory(date) {
      delete historyLog[date];
      saveHistoryLog();
      renderTasks();
      toggleHistory();  // ê¸°ë¡ ë³´ê¸° ëª¨ë‹¬ ë‹¤ì‹œ ë‹«ê¸°
    }

    if (localStorage.getItem("darkMode") === "true") {
      document.body.classList.add("dark");
    }

    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
        navigator.serviceWorker.register('/service-worker.js')
          .then(reg => console.log('ì„œë¹„ìŠ¤ ì›Œì»¤ ë“±ë¡ ì„±ê³µ:', reg))
          .catch(err => console.log('ì„œë¹„ìŠ¤ ì›Œì»¤ ë“±ë¡ ì‹¤íŒ¨:', err));
      });
    }

    document.getElementById("due-date").value = new Date().toISOString().split("T")[0];  // ì˜¤ëŠ˜ ë‚ ì§œ ì„¤ì •
    document.getElementById("new-task").addEventListener("keypress", function(e) {
  if (e.key === "Enter") addTask();
});

    renderTasks();
 
    updateRankDisplay();  // ë“±ê¸‰ í‘œì‹œ ì´ˆê¸°í™”


  </script>
</body>
</html>
